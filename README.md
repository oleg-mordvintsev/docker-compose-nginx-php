# Docker-compose with PHP + NGINX
Это пустой проект для создания связки контейнеров докер сервисов (PHP и NGINX) с помощью docker-compose

## Copyright
Мордвинцев О.Ю.  

## Технологии:
- Docker
- Docker-compose
- Backend: php7.4-fpm
- Server: nginx

### Необходимые компоненты
Эти компоненты уже должны быть Вами установлены для локального ( на вашем ПК) развертывания.
- git <details>
        <summary>подробнее...</summary>
        Необходим для клонирования репозитория, хотя вы можете и скачать архивом.<br/>
        Для Windows git доступен тут https://git-scm.com/<br/>
        Для Linux от root выполнить установку. Для Debian подобных (Ubuntu) `apt install git` 
        или Для Red Hat подобных (CentOS) `yum install git`<br/>
        Если Вы не root, то попробуйте команду `sudo -i`, которая поможет выполнить команды Выше от root.
    </details>
- docker <details>
        <summary>подробнее...</summary>
        Для создания контейнеров с нужными сервисами. Сразу содержит и docker-compose, т.е. отдельно установки 
        не требует.<br/>
        Для Windows docker доступен тут https://www.docker.com/<br/>
        Для Linux от root выполнить установку. Для Debian подобных (Ubuntu) `apt install docker`
        или Для Red Hat подобных (CentOS) `yum install docker`<br/>
        Если Вы не root, то попробуйте команду `sudo -i`, которая поможет выполнить команды Выше от root.<br/>
        Так же стоит обратить внимание на инструкцию по установке https://losst.ru/ustanovka-docker-na-ubuntu-16-04
    </details>


## Установка и запуск
1) В корневой директории будущего проекта, где уже будут храниться исполняемые файлы, необходимо выполнить команду в терминале:
    <details>
        <summary>подробнее...</summary>
        - Если Вы в Windows, и устанавливали git по вышеуказанной ссылке со значениями по умолчанию, 
        то в любой директории проводника в контекстном меню есть пункт "Git BASH Here".<br/>
        - Если Вы в Windows, то можете в проводнике перейти в нужную директорию, зажать Shift и правую кнопку мыши, 
        где в контекстном меню будет пункт "Открыть окно CMD здесь" или "Открыть окно PowerShell здесь".<br/>
        - Если Вы в Linux, то, скорее всего, Вы знаете, что делать, используйте команду "cd" в терминале для перехода 
        в директорию Вашего нового проекта.<br/>
        - Обратите внимание на точку в конце, она означает, что файлы скачаются в директорию, из которой
        выполняется команда. Если Вы находитесь в директории проекта, но хотите установить в под директорию,
        то используйте вместо точки название/путь до вложенной директории, к примеру:<br/>
        `git clone https://github.com/oleg-mordvintsev/docker-compose-nginx-php.git directoryInner/directory`
    </details>
    
>`git clone https://github.com/oleg-mordvintsev/docker-compose-nginx-php.git .`  

2) После того, как git получил необходимые файлы, надо запустить проект сследующей командой и НЕ закрывать терминал:
    <details>
        <summary>подробнее...</summary>
        - up - Создать и запустить контейнеры<br/>
        - --build - Создать или пересоздать контейнеры<br/>
        - --remove-orphans - Удаляем контейнеры с сервисами проекта, которых нет в Compose файле
    </details>

>`docker-compose up --build --remove-orphans`  

Во время выполнения может быть выведено много данных, но итогом джолжен быть следующий вывод в терминале:

> `Creating docker-compose-nginx-php-nginx   ... done`  
> `Creating docker-compose-nginx-php-php-fpm ... done`  

3) Не закрывая терминал запускаем браузер и вводим адрес http://127.0.0.1:8901

## Вопросы и тонкие настройки

1) Почему я вижу сайт на 8901 порту и могу ли я его изменить?
> Да, Вы можете использовать любой свободный порт. Изменить его можно в файле `docker-compose.yml` 
смотрите строку `ports`

2) Почему на сайте вижу страницу информации php вместо какой либо другой страницы?
> По умолчанию, для показа сайта устанавливается единственный файл `app/index.php`, т.е. в директории `app` может 
находиться Ваш сайт, работающий только на php.

3) Можно ли выполнять команды терминала в docker контейнерах?
> Да, это возможно, для запуска можете использовать следующие команды, соответствующие двум запускаемым контейнерам
`docker exec -it docker-compose-nginx-php-nginx bash`
`docker exec -it docker-compose-nginx-php-php-fpm bash`

4) Как мне сменить название проекта?
> Необходимо отредактировать файл `.env` со строкой `PROJECT_NAME=`.

5) Где посмотреть общий список назначения портов, чтобы я лишний не занимал?
> https://ru.wikipedia.org/wiki/Список_портов_TCP_и_UDP

6) Как запустить контейнеры в фоне, чтобы закрыть терминал?
>`docker-compose up -d --build --remove-orphans` 

7) Как остановить контейнеры?
> Если запущен терминал с контейнерами, т.е. контейнеры запущены не в фоне, то нажмите сочетание клавишь `CTRL + C`.
> Если запущены контейнеры в фоне, то в терминале необходимо ввести `docker stop $(docker ps -a -q)` это остановит абсолютно все контейнеры.
> Если нужно остановить конкретный контейнер, то необходимо получить их список `docker ps` и остановить нужный `docker stop {тут нужный CONTAINER ID без фигурных скобок}`

